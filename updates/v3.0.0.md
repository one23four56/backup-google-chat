
<h1 style="font-size:4em;margin-bottom:0">Overhaul Update</h1>
<h2 style="font-size:1.75em;margin:0;">v3.0.0</h2>
<title>Overhaul Update - Backup Google Chat Update Logs</title>

<hr>

<div style="background-color:ffd18a;border-radius:15px;border: 3px solid orange;text-align: center">
    <h3>Versioning Notice:</h3>
    <p>If you have been paying attention to update versions, you may be confused as the last update was called v1.6.2, and this is v3.0. There was not a jump over v2, every update was just renamed because the old system sucked. All updates that used to begin with v1 now begin with v2. All updates that used to begin with "old v1" are now just v1. This is to prevent confusion, as having a set of updates called "old version 1" and other called "version 1" makes no sense. Additionally, the DM update (formerly old v1.9) is now v2 because v2 was skipped over for some reason.</p>
</div>

<hr>

# Highlights

- Added chat rooms ([details](#rooms))

- Improved polls ([details](#bots))

<hr>

# Full Changelog

## Rooms

- **Summary:** Support for individual chat rooms has been added, rather than having the whole site be one room.

- **Details:**

  - Completely overhauled the entire client-side channel system

    - Client-side channels are now more modularized and significantly easier to work with

    - Performance has been improved, specifically relating to editing and deleting messages, as the site no longer has to redraw every message for a minor update to one

    - Added a new message bar system that is not affected by many issues that plagued the old one, as well as being easier to work with

    - Added a top bar to switch between different views (chat, rules, members, options) in a room

      - Chat is where messages are sent

      - Rules shows description and rules (editable by room owner)

      - Members shows room members (can be added/removed from here)

    - New sidebar system: each room has its own sidebar, which has options to open the room bots, stats, and archive pages as well as the list of online users

  - Added a new server-side room system

    - Essentially each room is like a tiny copy of the old site

    - Necessitated large changes to many modules in order for them to work properly

- **Notes:** it may not seem like much, but this was huge. the entire site was written to function as a single chat room, and was worked on under that assumption for just over a year. coming in and changing that all of a sudden has been a massive pain and was only possible because of the large amount of time i had while working on this update. before this i didn't even think it would be possible. even then, at the time of writing this, it is not even fully complete. i've got no idea what the future holds for this site, but i am hoping that this new system is able to last as long as the old one did. also specific details were a bit lacking in this section because i totally forgot i was supposed to keep an update log until rooms were basically finished

## Event Handling & Client-Server Communication

- **Summary:** New and better system for handling communications between the clients and the server

- **Details:**

  - Event handlers are now generated on a per-client basis, meaning every time you connect you get your own custom event handlers

  - Increased security against malformed requests, so the site should crash less

  - New system is able to handle rooms, which was completely impossible with the old one

## Webhooks

- **Summary:** Minor changes to webhooks on the surface, but there were some pretty significant internal changes.

- **Details:**

  - Large internal changes to webhooks in order for them to work with rooms
  
    - Webhook messages are now handled the exact same as normal messages

  - The message tag for webhooks messages has been changed from 'BOT' to 'WEBHOOK' to prevent confusion for new users, and the tag's background color is darker to make it easier to read.

  - Slight changes to webhook creation UI, as the public/private selection is now made via a confirm (yes/no) popup instead of a checkbox.

  - Changed the messages that show up when you edit/create/delete a webhook to be more grammatically correct and more consistent with each other.

## Bots

- **Summary:** Bots now work in rooms, the bots page was updated, some bots have had name and/or image changes, and polly has been upgraded

- **Details:**
  
  - Bots now work in rooms.

    - The room owner can choose which bots to allow in the room.

  - Bots can now only be activated once per message to prevent spam (i.e. sending a message like "/inspiro /time help" will now only run one of the commands).

    - Filter-activated bots are exempt from this rule.

  - Bot changes:

    - School Time Checker V3:

      - Renamed back to "Time Bot" to prevent confusion for new users

      - Updated the image

    - Archive Bot:

      - Updated the image to match with the archive icon

      - `/stats` command now omits archive size data from the message if given an argument

    - Random Bot: Updated the image

    - Polly:

      - Added duplicate vote checking since apparently there was none before

      - There are now dots after every option indicating the number of votes it has

        - Blue dots (ðŸ”µ) indicate someone else's vote, while green dots (ðŸŸ¢) indicate your vote

      - You can now update or remove your vote after it has been casted

      - You are no longer required to be online when a poll is created in order to vote in it, meaning you can vote in a poll that was started before you connected

      - Other internal improvements

  - The bots page has been updated:

    - The tutorial on how to use bots has been updated to be easier to understand

    - The button to open the page is now in the sidebar instead of the options menu

    - The page is now room specific, so the bots page for a specific room only shows bots allowed in that room

- **Notes:** i am just realizing now that polly was like really poorly implemented... like seriously i am surprised it didn't break more often

## Auto Moderator

- **Summary:** Automod strictness is now customizable by room owners, and automod has a new logo

- **Details:**

  - Internal updates to make mutes room-specific and add customizable settings

    - Room owners can change the strictness and number of warnings before a mute

  - Classic anti-spam (rate limiter) changes: Rate limiter is ever-so-slightly less strict by default

  - Reactive anti-spam changes:

    - Now capable of reacting to any rate of constant messages

    - Now comes in to effect sooner

  - New image that should load faster than the old one

## Command Helper

- **Summary:** Added a command helper that shows all the commands when typing

- **Details:**

  - Typing a slash (/) will open the helper

  - The helper shows all the commands, and narrows the commands down as you type

  - Once you have reached one possible command, the helper will show arguments for that command

## Messages

- **Summary:** Changes to message tags

- **Details:**

  - Patched an XSS vulnerability in tags (note: it was not actually possible to exploit this vulnerability at the time of the patch, which is why it was not patched for so long, as it was not seen as an issue)

  - Messages can now have multiple tags

    - Editing a message now adds the 'EDITED' tag to the list of tags, rather than replacing whatever the tag was with 'EDITED'

    - This patches the ability to impersonate someone by creating a webhook with their name and image, sending a message, and then editing it

## Minor Changes

- The loading screen now says what step of loading it is on, rather than just 'Loading...'

- Images on sidebar alerts are now 20% smaller

## Bugs Fixed

- Editing or deleting a selecting webhook messes up the display on the message bar (i.e. if you select a webhook named 'web' and change its name to 'hook', the bar will still say 'Send a message as web...').
